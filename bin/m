#!/usr/bin/env bash
# alias mw='m web'   # search web
# alias mf='m file'  # search file and open it
# alias mm='m man'   # search cheat 

DIR=$(dirname ~)
HOME=$DIR/$USER
WIKIHOME="$HOME/wiki"\ $LOCAL_WIKI_LIST # find with multiple directory

case $1 in

"man")
  if [[ -z $2 ]]; then
    echo "require second word"
    exit;
  fi
  cheat $2
  ;;

"vim")
  vim +Ack\ $2\ ~/wiki 
  ;;

"web")
  search=${@:2}
  open "https://github.com/yantze/wiki/search?q=$search"
  ;;

"webfile")
  keyword=${2%.md}
  filepath=$(find $WIKIHOME -type f -iname "*$keyword*.md" -o -iname "*$keyword*.txt" | head -n 1)
  if [[ -n $filepath ]]; then
    open "https://github.com/yantze/wiki/blob/master/${filepath##*wiki/}"
  fi
  ;;

"file")
  keyword=${2%.md}
  filepath=$(find $WIKIHOME -type f -iname "*$keyword*.md" -o -iname "*$keyword*.txt" | head -n 1)
  if [[ -n $filepath ]]; then
    vim $filepath
  fi
  ;;

*)
  if [[ $1 ]]; then
  #   hash ag 2>/dev/null || {
       # if not installed ag
       # grep -r -n -B 1 -A 2 "$1" $manfile
       # grep --color=auto -rn -B 1 -A 2 "$1" $manfile
       # -h 隐藏文件名
       # -r 递归查找
       # -n 显示行号
  #   }
  # else
    ag --pager less -B 1 -A 2 "$1" $WIKIHOME
  fi
  ;;
esac
